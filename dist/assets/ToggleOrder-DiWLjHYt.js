import{c as y,S as k,B as v}from"./button-CBBu9zPz.js";import{u as C,i as w}from"./useClearInfinityPages-Cbng7GPd.js";import{r as o,u as S,a as b,j as s,c as u,L as I,g as M}from"./index-BBOIb04p.js";import{p as A,f as L}from"./parseISO-D8VFmm5E.js";import{u as O}from"./useDebounce-eOa9egCm.js";import{S as _}from"./separator-9rsH-1Uw.js";import{S as f}from"./skeleton-F-vBBr6W.js";import{r as $}from"./ru-CK6oagpa.js";/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],U=y("eye-off",E);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m8 18 4 4 4-4",key:"bh5tu3"}],["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}]],B=y("move-vertical",q),F=t=>t&&{...t,data:t.data.map(a=>({...a,createdAt:A(a.createdAt)}))},g=(t,a,e)=>w({queryKey:["get","/manga/{mangaId}/chapters",t,30],queryFn:async({pageParam:r})=>await b.GET("/manga/{mangaId}/chapters",{params:{path:{mangaId:String(t)},query:{search:a,order:e,limit:30,page:r}}}).then(n=>F(n.data)),initialPageParam:1,getNextPageParam:r=>r==null?void 0:r.nextPage});function J(t){const[a,e]=o.useState("desc"),[r,n]=o.useState(""),{data:c,fetchNextPage:i,isFetching:d,isFetchingNextPage:m,refetch:p}=S(g(t,r,a)),x=C(g(t).queryKey);o.useEffect(()=>()=>{x()},[]);const h=O(()=>{x(),p()},500),j=o.useCallback(l=>{n(l),h()},[h]),N=o.useCallback(l=>{e(l),h()},[h]);return{chapters:c==null?void 0:c.pages.flatMap(l=>(l==null?void 0:l.data)||[]),fetchNextPage:i,isFetching:m||d,order:{value:a,onChange:N},search:{value:r,onChangeValue:j}}}const W=t=>{const{className:a,order:e,search:r,list:n}=t;return s.jsxs("div",{className:u("flex flex-col overflow-hidden",a),children:[s.jsxs("div",{className:"flex justify-between items-center gap-2 flex-wrap px-2.5 mb-4",children:[e,r]}),s.jsx(_,{}),s.jsx(k,{className:"overflow-auto",children:n})]})},P=t=>{const{className:a}=t;return s.jsxs("div",{className:u("flex items-center justify-center gap-2 w-full px-4 py-2.5",a),children:[s.jsxs("div",{className:"flex items-center w-full grow-1 gap-1",children:[s.jsx(f,{className:"rounded-[50%] w-5 h-5 "}),s.jsx(f,{className:"w-full h-4"})]}),s.jsx(f,{className:"w-20 h-4"})]})},X=t=>{const{className:a,chapters:e,renderChapter:r,isLoading:n,skeletonsCount:c=10,action:i}=t,d=o.useMemo(()=>Array(c).fill(0).map((m,p)=>s.jsx(P,{},p+"sk")),[c]);return s.jsxs("div",{className:a,children:[e.map(r),n&&d.map(m=>m),i]})};function R(t,a,e){return`${t}-tome--${a}-chapter---${e}`.replaceAll(".",",")}const Y=t=>{const{className:a,chapter:e,before:r,after:n,mangaId:c,onClick:i}=t;return s.jsxs(I,{to:M.MANGA_READ(c,R(e.tome,e.chapter,e.id)),className:u("grid grid-cols-[auto_1fr_auto_auto] overflow-hidden px-4 py-2.5 items-center gap-2 hover:bg-accent",a),onClick:i,children:[r||s.jsx("div",{}),s.jsx("div",{className:"whitespace-nowrap overflow-hidden text-ellipsis",children:`${e.tome} том ${e.chapter} глава${e.title?` - ${e.title}`:""}`}),s.jsx("div",{children:L(e.createdAt,"dd.mm.yyyy",{locale:$})}),n]})},Z=t=>{const{onChange:a,value:e,className:r}=t,[n,c]=o.useState("desc"),i=o.useCallback(()=>{const d=(e||n)==="asc"?"desc":"asc";e&&a?a(d):c(d)},[a,n,e]);return s.jsxs(v,{className:u("flex justify-center items-center gap-2",r),variant:"outline",size:"sm",onClick:i,children:[s.jsx(B,{}),e||n]})};export{W as B,X as C,U as E,Z as T,Y as a,R as g,J as u};
